from flask import Flask, render_template, request
import tensorflow as tf
import numpy as np
import cv2
import os

app = Flask(_name_)
model = tf.keras.models.load_model('model/smart_model.h5')
class_names = ['freshapples', 'freshbananas', 'rottenapples', 'rottenbananas']

@app.route('/', methods=['GET', 'POST'])
def index():
    prediction = ''
    if request.method == 'POST':
        image = request.files['image']
        image_path = 'static/' + image.filename
        image.save(image_path)

        img = cv2.imread(image_path)
        img = cv2.resize(img, (224, 224))
        img = img / 255.0
        img = np.expand_dims(img, axis=0)

        pred = model.predict(img)
        class_idx = np.argmax(pred)
        prediction = class_names[class_idx]

        return render_template('index.html', prediction=prediction, img_path=image_path)

    return render_template('index.html', prediction=prediction)

if _name_ == '_main_':
    app.run(debug=True)
<!DOCTYPE html>
<html>
<head>
  <title>Smart Sorting</title>
</head>
<body>
  <h2>Upload Fruit or Vegetable Image</h2>
  <form method="POST" enctype="multipart/form-data">
    <input type="file" name="image" required>
    <input type="submit" value="Predict">
  </form>
  {% if prediction %}
    <h3>Prediction: {{ prediction }}</h3>
    <img src="{{ img_path }}" width="300">
  {% endif %}
</body>
</html>
